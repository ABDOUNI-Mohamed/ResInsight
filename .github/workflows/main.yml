name: ResInsight Build

on: [push]

jobs:
  ResInsight-x64:

    runs-on: windows-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Install Qt
        uses: ouuan/install-qt-action@v2.3.1
        with:
          version: 5.9.1
          host: windows
          target: desktop
          arch: win64_msvc2017_64
          modules: qtscript 
      - name: Build ResInsight-x64
        env:
          CMAKE_PREFIX_PATH: ${{ runner.workspace }}\Qt\5.9.1\msvc2017_64
        run: |
          mkdir cmakebuild
          cd cmakebuild
          cmake .. -DRESINSIGHT_ENABLE_PRECOMPILED_HEADERS=true -DRESINSIGHT_ENABLE_UNITY_BUILD=true
          cmake --build . --config Release --target PACKAGE
      - name: Upload artifact
        uses: actions/upload-artifact@v1
        with:
          name: ResInsight.zip
          path: ${{ runner.workspace }}\cmakebuild\ResInsight*.zip
